<!-- Сторінка повного перегляду проєкту -->
<section class="project-detail">
  <!-- Індикатор завантаження -->
  @if (loading) {
    <div class="project-detail__loading">
      <div class="project-detail__spinner"></div>
      <p>{{ i18n.t('project.loading') }}</p>
    </div>
  }

  <!-- Проєкт не знайдено -->
  @if (!loading && !project) {
    <div class="project-detail__not-found">
      <h2>{{ i18n.t('project.notFound') }}</h2>
      <a routerLink="/projects" class="project-detail__back">{{ i18n.t('project.backToProjects') }}</a>
    </div>
  }

  <!-- Контент проєкту -->
  @if (project) {
    <article class="project-detail__article">
      <!-- Кнопка "назад" -->
      <a routerLink="/projects" class="project-detail__back">{{ i18n.t('project.back') }}</a>

      <!-- Головне зображення -->
      <div class="project-detail__cover">
        <img [src]="project.coverImage" [alt]="getTranslation(project).title" />
      </div>

      <!-- Заголовок -->
      <h1 class="project-detail__title">{{ getTranslation(project).title }}</h1>

      <!-- Плашка "не перекладено" -->
      @if (!isTranslationAvailable) {
        <div class="project-detail__translation-notice">
          ⚠️ {{ i18n.t('project.notTranslated') }} {{ currentLanguageName }}
        </div>
      }

      <!-- Мета-інформація -->
      <div class="project-detail__meta">
        <time>{{ project.createdAt | date:'dd MMMM yyyy':undefined:i18n.currentLang }}</time>
        @if (project.authors.length > 0) {
          <span>•</span>
          <span>{{ project.authors.join(', ') }}</span>
        }
      </div>

      <!-- Посилання на демо та репозиторій -->
      <div class="project-detail__links">
        @if (project.liveUrl) {
          <a [href]="project.liveUrl" target="_blank" rel="noopener noreferrer" class="project-detail__link project-detail__link--live">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="2" y1="12" x2="22" y2="12"/>
              <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
            </svg>
            <span>{{ i18n.t('project.viewDemo') }}</span>
          </a>
        }
        @if (project.repoUrl) {
          <a [href]="project.repoUrl" target="_blank" rel="noopener noreferrer" class="project-detail__link project-detail__link--repo">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
            </svg>
            <span>{{ i18n.t('project.viewRepo') }}</span>
          </a>
        }
      </div>

      <!-- Хештеги -->
      <div class="project-detail__tags">
        @for (tag of project.tags; track tag) {
          <a
            class="project-detail__tag"
            [routerLink]="['/search']"
            [queryParams]="{ tag: tag }"
          >
            #{{ tag }}
          </a>
        }
      </div>

      <!-- Повний опис проєкту -->
      <div class="project-detail__content" [innerHTML]="renderedContent"></div>

      <!-- Галерея додаткових фото -->
      @if (project.gallery && project.gallery.length > 0) {
        <div class="project-detail__gallery">
          <h2 class="project-detail__gallery-title">{{ i18n.t('project.gallery') }}</h2>

          <!-- Слайдер -->
          <div class="project-detail__slider">
            <button class="project-detail__slider-btn" (click)="prevImage()">‹</button>

            <div class="project-detail__slider-image">
              <img
                [src]="project.gallery[currentImageIndex]"
                [alt]="getTranslation(project).title + ' - фото ' + (currentImageIndex + 1)"
              />
            </div>

            <button class="project-detail__slider-btn" (click)="nextImage()">›</button>
          </div>

          <!-- Індикатори (точки) -->
          <div class="project-detail__dots">
            @for (img of project.gallery; track $index; let i = $index) {
              <button
                class="project-detail__dot"
                [class.project-detail__dot--active]="i === currentImageIndex"
                (click)="goToImage(i)"
              ></button>
            }
          </div>
        </div>
      }
    </article>
  }
</section>
